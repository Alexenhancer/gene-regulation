rule split_bam_by_strands:
    """Split a bam file in two separate bam files containing respectively 
    the reads on the plus and minus strand. """
        input: "{smp}.bam"
        output: min="{smp}_min.bam", plus="{smp}_plus.bam"
        shell: """
              samtools  view -f99 -hb {input} > {output.min}_99.bam
              samtools  view -f147 -hb {input} > {output.min}_147.bam
              samtools  view -f83 -hb {input} > {output.plus}_83.bam
              samtools  view -f163 -hb {input} > {output.plus}_163.bam
      
              samtools merge -h {output.min}_99.bam  {output.min} {output.min}_99.bam {output.min}_147.bam
              samtools merge -h {output.plus}_83.bam {output.plus} {output.plus}_83.bam {output.plus}_163.bam
      
              rm -f {output.min}_99.bam  {output.min}_147.bam {output.plus}_83.bam {output.plus}_163.bam
        """
