rule homer:
	"""Peak-calling with HOMER software, findPeaks algorithm (!).
	Input formats: .sam, .bam, .bed 

	Required parameters:
		config["genome"]["genome_version"]
		config["qsub"]

	Usage:
HOMER = expand(RESULTSDIR + "{chip}_vs_{inp}/{chip}_vs_{inp}_" + TRIMMING + "_{aligner}_homer.bed", chip=CHIP, inp=INPUT, aligner=ALIGNERS)
	"""
	input: 
		chip = "GSM1217459/GSM1217459_sickle_se_q20_bwa.bed", \
		inp = "GSM1217457/GSM1217457_sickle_se_q20_bwa.bed".split()
	output: 
		"GSM1217459_vs_GSM1217457/GSM1217459_vs_GSM1217457_homer.bed"
	params:
		chip_tag="Homer_GSM1217459", \
		input_tag="Homer_GSM1217457", \
		genome=config['genome']['genome_version'], \
		qsub = config["qsub"] + " -e {input.chip}_homer_qsub.err -o {input.chip}_homer_qsub.out"

	shell:"""makeTagDirectory {params.chip_tag} -genome {params.genome} -checkGC {input.chip}
		makeTagDirectory {params.input_tag} -genome {params.genome} -checkGC {input.inp}
		findPeaks {params.chip_tag} -style factor -o auto -i {params.input_tag}
		pos2bed.pl {params.chip_tag}/peaks.txt > {output}
		"""
