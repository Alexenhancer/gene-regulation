"""TODO: implement BWA index

"""

rule bwa:
	"""Read mapping using BWA.
	"""
	input: RESULTSDIR + "{gsm}/{gsm}_trimmed.fastq"
	output: RESULTSDIR + "{gsm}/{gsm}_bwa.sam"
	log: RESULTSDIR + "{gsm}/{gsm}_bwa.log"
	benchmark: RESULTSDIR + "{gsm}/{gsm}_bwa_benchmark.json"
	params:
		index="genomes/BWAIndex/genome.fa", \
		sai=RESULTSDIR + "{gsm}/{gsm}_bwa.sai"
	shell:
		"bwa aln -t 12 {params.index} {input} > {params.sai} 2> {log}; \
		bwa samse {params.index} {params.sai} {input} > {output} 2> {log} "
