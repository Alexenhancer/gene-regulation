"""
	Check the quality of fastq-formatted raw reads using the program fastQC (quality control).

"""


rule fastqc:
    """Check the quality of the {dataset}.fastq file containing fastq-formatted raw reads using the program fastQC (quality control).
    You can add any wanted parameters in the "other options" of the config file.
    The results are put into a folder named '{dataset}_fastqc'.
    """
    
    input: config["results_directory"] + "{reads}.fastq"
    output: config["results_directory"] + "{reads}_fastqc/"
    log: config["results_directory"] + "{reads}_fastqc/{wildcards.dataset}_fastqc.log"
    benchmark: config["results_directory"] + "{reads}_fastqc/{wildcards.dataset}_fastqc_benchmark.json"
    params: qsub = config["qsub"] + " -q short -e " + config["results_directory"] + "{reads}_fastqc/{wildcards.dataset}_fastqc_qsub.err -o " + config["results_directory"] + "{reads}_fastqc/{wildcards.dataset}_fastqc_qsub.out", options = config["fastqc"]["other_options"]
    shell:"fastqc --outdir {output} --format fastq {input} {params.options} 2> {log} "
