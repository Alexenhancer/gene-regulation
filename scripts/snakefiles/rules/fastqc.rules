"""Check the quality of a file named {dataset}.fastq, containing
fastq-formatted raw reads using the program fastQC (quality
control).  You can add any wanted parameters in the "other
options" of the config file.  The results are put into a folder
named '{dataset}_fastqc'.

Required parameters:
    config['qsub']

Optional parameters:
    config['fastqc']['other_options']

Usage:


Authors: 
    Claire Rioualen, Lucie Khamvongsa, Jacques van Helden
"""

# Set parameters
if not "qsub" in config.keys():
    sys.exit("The parameter qsub must be defined in the config file")

if not "fastqc" in config.keys():
    config["fastqc"] = {}

if not "other_options" in config["fastqc"].keys():
    config["fastqc"]["other_options"] = ""

rule fastqc:
    input: "{reads}.fastq"
    output: "{reads}_fastqc/{sample}_fastqc.html"
    params:
        options = config["fastqc"]["other_options"], \
        outdir = "{reads}_fastqc/", \
        qsub = config["qsub"]\
            + " -e {reads}_fastqc/{sample}_fastqc_qsub.err"\
            + " -o {reads}_fastqc/{sample}_fastqc_qsub.out"
    log: "{reads}_fastqc/{sample}_fastqc.log"
    benchmark: "{reads}_fastqc/{sample}_fastqc_benchmark.json"
    shell:"fastqc --outdir {params.outdir} --format fastq {input} {params.options} 2> {log} "
