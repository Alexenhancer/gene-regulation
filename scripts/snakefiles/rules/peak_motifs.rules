"""TODO rule: peak-motifs analysis.
"""


PEAK_MOTIFS_TASKS = config["peak-motifs_parameters"]["tasks"]
MAX_SEQ_LENGTH = config["peak-motifs_parameters"]["max_seq_length"]
NMOTIFS = config["peak-motifs_parameters"]["nmotifs"]
MINOL = config["peak-motifs_parameters"]["minol"]
MAXOL = config["peak-motifs_parameters"]["maxol"]
MOTIF_DB = config["peak-motifs_parameters"]["motif_db"]

rule peak-motifs:
	"""Motif discovery using the peak-motifs pipeline.

	Find out more @ http://floresta.eead.csic.es/rsat/help.peak-motifs.html
	"""
	input: "{peaks}.fasta"
	output: "{peaks}.html"
	log: "{peaks}_peak-motifs.log"
	benchmark: "{peaks}_peak-motifs_bench.json"
	shell: "peak-motifs  -v 1 \
		-i  \
		-max_seq_len {MAX_SEQ_LENGTH} -markov auto -disco oligos,positions -nmotifs {NMOTIFS} -minol {MINOL} -maxol {MAXOL} -no_merge_lengths -2str -origin center \
		-motif_db {MOTIF_DB} \
		-scan_markov 1 \
		-task {PEAK_MOTIFS_TASKS} \
		-prefix peak-motifs -noov -img_format png \
		-outdir $RSAT/public_html/tmp/www-data/2015/06/25/peak-motifs.2015-06-25.152353_2015-06-25.152353_dbqQbx"



		"tasks" : "purge,seqlen,composition,disco,collect_motifs,motifs_vs_motifs,timelog,archive,synthesis,small_summary,motifs_vs_db,scan",
		"max_seq_len" : "1000",
		"nmotifs" : "",
		"minol" : "",
		"maxol" : "",
		"motif_db jaspar_core_vertebrates" : "tf $RSAT/public_html/motif_databases/JASPAR/jaspar_core_vertebrates_2013-11.tf"




peak-motifs -v 1 -i SWEMBL_mmus_CEBPA_vs_mmus_Input_peaks_R0.01_nof_purge.fasta -max_seq_len 1000 -markov auto -disco oligos,positions -nmotifs 5 -minol 6 -maxol 8 -motif_db jaspar_core_vertebrates tf $RSAT/public_html/motif_databases/JASPAR/jaspar_core_vertebrates_2015_03.tf -scan_markov 1 -task purge,seqlen,composition,disco,timelog,synthesis,small_summary,motifs_vs_db,scan -prefix peak-motifs -outdir .
