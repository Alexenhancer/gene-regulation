rule peak_motifs:
	"""Motif discovery using the peak-motifs pipeline.

	Find out more @ http://floresta.eead.csic.es/rsat/help.peak-motifs.html
	
	Required parameters:
		config['qsub']
		config['peak-motifs_parameters']['tasks']
		config['peak-motifs_parameters']['disco']
		config['peak-motifs_parameters']['motif_db']
		config['peak-motifs_parameters']['outdir']

	Usage example: 
		input: expand("peak-motifs_synthesis.html")
		shell: "peak-motifs -v 1 -i peaks.fasta  -disco oligos,positions \
			-motif_db jaspar_core_vertebrates tf $RSAT/public_html/motif_databases/JASPAR/jaspar_core_vertebrates_2013-11.tf \
			-task purge,seqlen,composition,disco,synthesis,small_summary,motifs_vs_db,scan -prefix peak-motifs -outdir results/peak-motifs"
	"""
	input: "{peaks}.fasta"
	output: "{peaks}.html"
	params:
		qsub = config['qsub'], \
		tasks = config['peak-motifs_parameters']['tasks'], \
		disco = config['peak-motifs_parameters']['disco'], \
		motif_db = config['peak-motifs_parameters']['motif_db'], \
		outdir = config['peak-motifs_parameters']['outdir']
	log: "{peaks}_peak-motifs.log"
	benchmark: "{peaks}_peak-motifs_bench.json"
	shell: "peak-motifs  -v 1 -i  {input} -disco {params.disco} -motif_db {params.motif_db} -task {params.tasks} -prefix peak-motifs -outdir {params.outdir}"


#peak-motifs -v 1 -i SWEMBL_mmus_CEBPA_vs_mmus_Input_peaks_R0.01_nof_purge.fasta  -disco oligos,positions -motif_db jaspar_core_vertebrates tf $RSAT/public_html/motif_databases/JASPAR/jaspar_core_vertebrates_2013-11.tf -task purge,seqlen,composition,disco,synthesis,small_summary,motifs_vs_db,scan -prefix peak-motifs -outdir .


