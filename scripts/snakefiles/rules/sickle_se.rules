"""
    Trim reads required before alignement 

"""
rule sickle_single_end:
    	"""Trim one a single end raw reads file with sickle.
	
	Parameters required:
		config['sickle']['threshold']
		config['sickle']['qual_type']
		config['sickle']['other_options']
		config['qsub']
	Usage:
		SICKLE_TRIMMING = expand(config['dir']['results'] + "{dir_data}/{dataset}_merged_sickle_se_q" + config['sickle']['threshold'] + ".fastq", dir_data=DIR_DATA, dataset=DATASETS)
	"""
    input: "{reads}.fastq"
    output: trimmed = "{reads}_sickle_se_q" + config['sickle']['threshold'] + ".fastq", \
            summary = "{reads}_sickle_se_q" + config['sickle']['threshold'] + "_summary.txt"
    params: threshold = config['sickle']['threshold'], \
            qual_type = config['sickle']['qual_type'], \
            options = config['sickle']['other_options'], \
            qsub = config['qsub'] \
            + " -e {reads}_sickle_se_q" + config['sickle']['threshold'] + "_qsub.err" \
            + " -o {reads}_sickle_se_q" + config['sickle']['threshold'] + "_qsub.out"
    log: "{reads}_sickle_se_q" + config['sickle']['threshold'] + ".log"
    benchmark: "{reads}_sickle_se_q" + config['sickle']['threshold'] + "_benchmark.json"
    message: "Trimming single-end raw reads with sickle\n\tInput:\t{input}\n\tOutput:\t{output}\n\tLog:\t{log}"
    shell: "sickle se --fastq-file {input} --qual-type {params.qual_type} --output-file {output.trimmed}  {params.options} > {output.summary} 2> {log}"


# rule sickle_se:
# 	"""Trim one raw read file (fastq format) from SRR.

# 	Changement faits : 
# 		- remplacé "trimmed" par "sickle" (au cas où on utilise d'autres algo de trimming)
# 		- suffixe "import" pour les data (après synchronisation, merging ou autre -> data prêt à l'emploi != raw data)
# 		- dans la config ultime de Jacques, 'quality_type' s'est transformé en 'qual_type'
# 	"""
# 	input: config['dir']['results'] + "{samples}/{samples}_import.fastq"
# 	output: config['dir']['results'] + "{samples}/{samples}_sickle.fastq"
#     	params: 
# 		qual_type = config['sickle']['qual_type'], \
# 		qsub = config['qsub'] + " -e " + config['dir']['logs'] + "{samples}/{samples}_sickle_qsub.err -o " + config['dir']['logs'] + "{samples}/{samples}_sickle_qsub.out"
# 	log: config['dir']['logs'] + "{samples}/{samples}_sickle.log"
# 	benchmark: config['dir']['logs'] +"{samples}/{samples}_sickle_benchmark.json"
# 	message: "Trimming raw reads with sickle\n\tInput:\t{input}\n\tOutput:\t{output}\n\tLog:\t{log}"
# 	shell: "sickle se --fastq-file {input} --qual-type {params.qual_type} --output-file {output} 2> {log}"

