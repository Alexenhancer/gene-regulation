"""
    Trim reads required before alignement 

"""

# rule trim_all:
#     """Trim short reads (after merging) for each sample"""
#     input:expand('{read_dir}/{gsm}/{gsm}_trimmed.fastq', gsm=GSM_LIST, read_dir={CHIP_READ_DIR})

rule trim_sickle:
    """Trim one raw read file (fastq format) from SRR."""
    input: CHIP_READ_DIR + "/{gsm}/{gsm}.fastq"
    output: CHIP_READ_DIR + "/{gsm}/{gsm}_trimmed.fastq"
    params: qsub = config["qsub"] + " -e " + CHIP_READ_DIR + "/{gsm}/{gsm}_trimmed_qsub.err -o " + CHIP_READ_DIR + "/{gsm}/{gsm}_trimmed_qsub.out"
    log: CHIP_READ_DIR + "/{gsm}/{gsm}_trimmed.log"
    benchmark: CHIP_READ_DIR +"/{gsm}/{gsm}_trimmed_benchmark.json"
    message: "Trimming raw reads with sickle\n\tInput:\t{input}\n\tOutput:\t{output}\n\tLog:\t{log}"
    shell: "sickle se --fastq-file {input} --qual-type {QUALITY_TYPE} --output-file {output} 2> {log}"
