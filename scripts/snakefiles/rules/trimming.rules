"""
Trim all the merged.fastq files

"""

rule trim_all:
    """Trim short reads (after merging) for each sample"""
    input:expand('{read_dir}/{gsm}/{gsm}_trimmed.fastq', gsm=GSM_LIST, read_dir={CHIP_READ_DIR})

rule trim_sickle:
    """Trim one raw read file (fastq format) from SRR."""
    input: "{read_dir}/{gsm}/{gsm}_merged.fastq"
    output: "{read_dir}/{gsm}/{gsm}_trimmed.fastq"
    params: qsub = QSUB_PARAM + " -e {read_dir}/{gsm}/{gsm}_trimmed_qsub.err -o {read_dir}/{gsm}/{gsm}_trimmed_qsub.out"
    log: "{read_dir}/{gsm}/{gsm}_trimmed.log"
    benchmark: "{read_dir}/{gsm}/{gsm}_trimmed_benchmark.json"
    message: "Trimming raw reads with sickle\n\tInput:\t{input}\n\tOutput:\t{output}\n\tLog:\t{log}"
    shell: "sickle se --fastq-file {input} --qual-type {QUALITY_TYPE} --output-file {output} 2> {log}"