rule bowtie_pe:
    """Read mapping with bowtie version 1 (no gap) in paired end."""
    input: forward = "{reads_prefix}" + config["suffix"]["reads_fwd"] + "_sickle_pe_q" + config["sickle"]["threshold"] + ".fastq", \
           reverse = "{reads_prefix}" + config["suffix"]["reads_rev"] + "_sickle_pe_q" + config["sickle"]["threshold"] + ".fastq", \
           index1 = config["bowtie"]["bowtie_index"] + ".1.ebwt"
    output: sam = "{reads_prefix}_sickle_pe_q" + config["sickle"]["threshold"] + "_bowtie_pe.sam", \
            stdout =  "{reads_prefix}_sickle_pe_q" + config["sickle"]["threshold"] + "_bowtie_pe.stdout"
    log: "{reads_prefix}_sickle_pe_q" + config["sickle"]["threshold"] + "_bowtie_pe.log"
    benchmark: "{reads_prefix}_sickle_pe_q" + config["sickle"]["threshold"] + "_bowtie_pe_benchmark.json"
    params: max_mismatches = config["bowtie"]["max_mismatches"], \
            reads_iso = config["bowtie"]["reads_iso"], \
            index = config["bowtie"]["bowtie_index"], \
            qsub = config["qsub"] + " -q long -e {reads_prefix}_bowtie_qsub.err -o {reads_prefix}_bowtie_qsub.out"
    shell: "bowtie -t -q -S -n {params.max_mismatches} -m {params.reads_iso} --phred33-quals {params.index}" \
           + " -1 {input.forward} -2 {input.reverse} {output.sam} > {output.stdout} 2> {log}"
