
rule peak_length:
	"""Generates density graphs of the peaks length distributions.
	"""
	input: RESULTSDIR + "{CHIP}_vs_{INPUT}/{CHIP}_{ALIGNER}_purged.fasta"
	output: RESULTSDIR + "{CHIP}_vs_{INPUT}/{CHIP}_{ALIGNER}_length.png"
	benchmark: RESULTSDIR + "{CHIP}_vs_{INPUT}/{CHIP}_{ALIGNER}_peak-length_benchmark.json"
	run:
		R("""library("Biostrings")

		s = readDNAStringSet("{input}")

		d <- density(width(s))	
	
		png("{output}")
		plot(d)
		dev.off()
		""")

## fonctions dans RSAT ??
