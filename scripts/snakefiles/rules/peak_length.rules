
rule peak_length:
	"""Generates density graphs of the peaks length distributions.

	Required parameters:
		config["qsub"]

	Usage example: 
		input:expand(config["dir"]["results"] + '{{histonemark}}/{tissue}/{sample}_length.png', zip, tissue=TISSUES, sample=SAMPLES), histonemark=MARKS)
	"""
	input: "{peaks}.fasta"
	output: "{peaks}_length.png"
	benchmark: "{peaks}_length_benchmark.json"
	log: "{peaks}_length.log"
	params: qsub = config['qsub'] + "  -e {peaks}_qsub.err -o {peaks}_qsub.out"

	run:
		R("""sink("{log}")
		library("Biostrings")

		s = readDNAStringSet("{input}")

		d <- density(width(s))	
	
		png("{output}")
		plot(d)
		dev.off()

		sink()
		""")
