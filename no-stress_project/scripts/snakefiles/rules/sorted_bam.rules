"""
    =======================================
    Definition of the sorting rule bam file
    =======================================
"""

# rule sorted_bam_all:
#     """Sort each bamfiles"""
#     input:expand('{read_dir}/{gsm}/{gsm}_bowtie_sorted.bam', gsm = GSM_LIST, read_dir = CHIP_READ_DIR) 

rule sorted_bam:
    input: "{data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + ".bam"
    output: "{data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + "_sorted_" + config["htseq"]["order"] + ".bam"
    log: "{data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + "_sorted.log"
    benchmark: "{data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + "_sorted_benchmark.json"
    params: sort_by_name = config["samtools"]["sort_by_name"], qsub = config["qsub"] + " -q long -e {data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + "_sorted_" + config["htseq"]["order"] + "_qsub.err -o {data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + "_sorted_" + config["htseq"]["order"] + "_qsub.out"
    shell:"samtools sort{params.sort_by_name} {input} {wildcards.reads}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + "_sorted_" + config["htseq"]["order"] + " 2> {log}"
    
