"""
	Check the quality of fastq-formatted raw reads using the program fastQC (quality control).

"""


rule fastqc:
    """Check the quality of a file named {dataset}.fastq, containing
    fastq-formatted raw reads using the program fastQC (quality
    control).  You can add any wanted parameters in the "other
    options" of the config file.  The results are put into a folder
    named '{dataset}_fastqc'.

    Required parameters:
        config['fastqc']['other_options']
        config['qsub']  

    Usage:
        QC = expand(config['dir']['results'] + "{data_dir}/{dataset}_fastqc/", dir_data=DIR_DATA, dataset=DATASETS)

    """
    input: config["dir"]["data_root"] + "{data_dir}/{dataset}.fastq"
    output: outdir = config["dir"]["results"] + "{data_dir}/{dataset}_fastqc/"
    log: config["dir"]["results"] + "{data_dir}/{dataset}_fastqc/{dataset}_fastqc.log"
    benchmark: config["dir"]["results"] + "{data_dir}/{dataset}_fastqc/{dataset}_fastqc_benchmark.json"
    params: qsub = config["qsub"] + " -q short -e " + config["dir"]["results"] + "{data_dir}/{data_dir}_fastqc_qsub.err -o " + config["dir"]["results"] + "{data_dir}/{data_dir}_fastqc_qsub.out", \
            options = config["fastqc"]["other_options"]
    shell:"fastqc --outdir {output.outdir} --format fastq {input} {params.options} 2> {log} "





# rule fastqc:
#     """Check the quality of a file named {dataset}.fastq.gz, containing
#     fastq-formatted raw reads using the program fastQC (quality
#     control).  You can add any wanted parameters in the "other
#     options" of the config file.  The results are put into a folder
#     named '{dataset}_fastqc'.

#     """
    
#     input: "{data_dir}/{dataset}.fastq.gz"
#     output: outdir="{data_dir}/{dataset}_fastqc/"
#     log: "{data_dir}/{dataset}_fastqc/{dataset}_fastqc.log"
#     benchmark: "{data_dir}/{dataset}_fastqc/{dataset}_fastqc_benchmark.json"
#     params: qsub = config["qsub"] + " -q short -e {data_dir}/{data_dir}_fastqc_qsub.err -o {data_dir}/{data_dir}_fastqc_qsub.out", options = config["fastqc"]["other_options"]
#     shell:"fastqc --outdir {output.outdir} --format fastq {input} {params.options} 2> {log} "


# rule fastqc_trimmed:
#     """Check the quality of the {dataset}.fastq.gz file containing fastq-formatted raw reads using the program fastQC (quality control).
#     You can add any wanted parameters in the "other options" of the config file.
#     The results are put into a folder named '{dataset}_fastqc'.
#     """    
#     input: "{data_dir}/{dataset}_trimmed_thr" + config["sickle"]["threshold"] + ".fastq.gz"
#     output: "{data_dir}/{dataset}_trimmed_thr" + config["sickle"]["threshold"] + "_fastqc"
# #    output: outdir="{data_dir}/{dataset}_fastqc_trimmed/"
#     log: "{data_dir}/{dataset}_fastqc/{dataset}_trimmed_thr" + config["sickle"]["threshold"] + "_fastqc.log"
#     benchmark: "{data_dir}/{dataset}_fastqc/{dataset}_trimmed_thr" + config["sickle"]["threshold"] + "_fastqc_benchmark.json"
#     params: qsub = config["qsub"] + " -q short -e {data_dir}/{data_dir}_trimmed_thr" + config["sickle"]["threshold"] + "_fastqc_qsub.err -o {data_dir}/{data_dir}_trimmed_thr" + config["sickle"]["threshold"] + "_fastqc_qsub.out", options = config["fastqc"]["other_options"]
#     shell:"fastqc --outdir {output.outdir} --format fastq {input} {params.options} 2> {log} "
