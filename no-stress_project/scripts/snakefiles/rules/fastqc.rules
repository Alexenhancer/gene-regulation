"""
	Check the quality of fastq-formatted raw reads using the program fastQC (quality control).

"""


rule fastqc_raw:
    """Check the quality of the {dataset}.fastq.gz file containing fastq-formatted raw reads using the program fastQC (quality control).
    You can add any wanted parameters in the "other options" of the config file.
    The results are put into a folder named '{dataset}_fastqc'.
    """
    
    input: "{data_dir}/{dataset}.fastq.gz"
    output: outdir="{data_dir}/{dataset}_fastqc_raw/"
    log: "{data_dir}/{dataset}_fastqc/{dataset}_fastqc.log"
    benchmark: "{data_dir}/{dataset}_fastqc/{dataset}_fastqc_benchmark.json"
    params: qsub = QSUB_PARAM + " -q short -e {data_dir}/{data_dir}_fastqc_qsub.err -o {data_dir}/{data_dir}_fastqc_qsub.out", options = OPTIONS_FASTQC
    shell:"fastqc --outdir {output.outdir} --format fastq {input} {params.options} 2> {log} "


rule fastqc_trimmed:
    """Check the quality of the {dataset}.fastq.gz file containing fastq-formatted raw reads using the program fastQC (quality control).
    You can add any wanted parameters in the "other options" of the config file.
    The results are put into a folder named '{dataset}_fastqc'.
    """
    
    input: "{data_dir}/{dataset}_trimmed_thr" + THRESHOLD + ".fastq.gz"
    output: outdir="{data_dir}/{dataset}_fastqc_trimmed/"
    log: "{data_dir}/{dataset}_fastqc/{dataset}_trimmed_thr" + THRESHOLD + "_fastqc.log"
    benchmark: "{data_dir}/{dataset}_fastqc/{dataset}_trimmed_thr" + THRESHOLD + "_fastqc_benchmark.json"
    params: qsub = QSUB_PARAM + " -q short -e {data_dir}/{data_dir}_trimmed_thr" + THRESHOLD + "_fastqc_qsub.err -o {data_dir}/{data_dir}_trimmed_thr" + THRESHOLD + "_fastqc_qsub.out", options = OPTIONS_FASTQC
    shell:"fastqc --outdir {output.outdir} --format fastq {input} {params.options} 2> {log} "
