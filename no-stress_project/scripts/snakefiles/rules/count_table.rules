"""
    =======================================
    Definition of the count rule file
    =======================================
"""



rule count:
    input: "{data_dir}/{data_dir}_bowtie2_mm" + MAX_MISMATCHES + "_sorted_" + ORDER + ".bam"
    output: "{data_dir}/{data_dir}_bowtie2_mm" + MAX_MISMATCHES + "_sorted_" + ORDER + "_count.txt"
    log: "{data_dir}/{data_dir}_bowtie2_mm" + MAX_MISMATCHES + "_sorted_" + ORDER + "_count.log"
    benchmark: "{data_dir}/{data_dir}_bowtie2_mm" + MAX_MISMATCHES + "_sorted_" + ORDER + "_count_benchmark.json"
    params: ht_type = HT_TYPE , order = ORDER, stranded = STRANDED, minaqual = MINAQUAL, idattr = IDATTR, mode = MODE, gff_file = GFF_FILE, qsub = QSUB_PARAM + " -q long -e {data_dir}/{data_dir}_bowtie2_mm" + MAX_MISMATCHES + "_sorted_" + ORDER + "_count_qsub.err -o {data_dir}/{data_dir}_bowtie2_mm" + MAX_MISMATCHES + "_sorted_" + ORDER + "_count_qsub.out", options = OPTIONS_COUNT
    # message: """--- Counting."""
    shell: "htseq-count --format {params.ht_type} --order {params.order} --stranded {params.stranded} --minaqual {params.minaqual} --idattr {params.idattr} --mode {params.mode} {input} {params.gff_file} {params.options}> {output}"

