"""
    =============================
    Definition of sam to bam rule
    =============================
"""

# rule convert_sam_to_bam_all:
#     """Convert each sample samfiles to bamfiles"""
#     input:expand('{read_dir}/{gsm}/{gsm}_bowtie.bam', gsm=GSM_LIST, read_dir=CHIP_READ_DIR)

rule sam_to_bam:
    input: "{data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + ".sam"
    output: "{data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + ".bam"
    log: "{data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + "_sam_to_bam.log"
    benchmark: "{data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + "_sam_to_bam_benchmark.json"
    params: qsub=config["qsub"] + " -q short -e {data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + "_sam_to_bam_qsub.err -o {data_dir}/{data_dir}_bowtie2_mm" + config["bowtie2"]["max_mismatches"] + "_sam_to_bam_qsub.out"
    shell:"samtools view -bS -o {output} {input} 2> {log}"
