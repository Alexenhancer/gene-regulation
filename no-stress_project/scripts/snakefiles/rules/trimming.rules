"""
    Trim reads required before alignment 

"""

rule trimming_paired_end:
    """Trim all raw paired-end read files (fastq.gz format) using sickle.
    The forward and the reverse read files have to be named respectively '{data_dir}_1.fastq.gz' and '{data_dir}_2.fastq.gz'.
    The quality threshold (threshold) and the quality type (seq_type) parameters have to be determined in the config file (json format) linked in the snakefile (workflow).
    You can add any other wanted parameters in the "other options" of the config file.
    The result files are named '{data_dir}_1_trimmed.fastq.gz', '{reads}_2_trimmed.fastq.gz' and '{data_dir}_trimmed.fastq.gz'.
    """
    
    input: "{data_dir}/{data_dir}_1.fastq.gz", "{data_dir}/{data_dir}_2.fastq.gz"
    output: forward = "{data_dir}/{data_dir}_1_trimmed_thr" + config["sickle"]["threshold"] + ".fastq.gz", \
            reverse = "{data_dir}/{data_dir}_2_trimmed_thr" + config["sickle"]["threshold"] + ".fastq.gz", \
            single = "{data_dir}/{data_dir}_trimmed_thr" + config["sickle"]["threshold"] + ".fastq.gz"
    params: threshold = config["sickle"]["threshold"], seq_type=config["sickle"]["seq_type"], qsub=config["qsub"] + " -q long -e {data_dir}/{data_dir}_trim_qsub.err -o {data_dir}/{data_dir}_trim_qsub.out", options = config["sickle"]["other_options"]
    log: "{data_dir}/{data_dir}_trimmed_thr" + config["sickle"]["threshold"] + ".log"
    benchmark: "{data_dir}/{data_dir}_trimmed_benchmark_thr" + config["sickle"]["threshold"] + ".json"
    # message: "Trimming raw reads with sickle\n\tInput:\t{input}\n\tOutput:\t{output}\n\tLog:\t{log}"
    shell: "sickle pe --gzip-output --pe-file1 {input[0]} --pe-file2 {input[1]} --qual-type {params.seq_type} --qual-threshold {params.threshold} --output-pe1 {output[0]} --output-pe2 {output[1]} --output-single {output[2]} {params.options} 2> {log}"
